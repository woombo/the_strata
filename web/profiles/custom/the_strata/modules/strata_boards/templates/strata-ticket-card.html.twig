{#
/**
 * @file
 * Template for a ticket card on the board.
 *
 * Available variables:
 * - ticket: The ticket node entity.
 * - title: The ticket title.
 * - description: First 200 chars of description.
 * - deadline: The deadline date (DateTimeInterface or null).
 * - ticket_type: The ticket type term (or null).
 * - assigned_to: The assigned user (or null).
 * - ticket_url: URL to the ticket node.
 * - comment_count: Number of comments on the ticket.
 * - file_count: Number of files attached to the ticket.
 * - created: The created timestamp.
 */
#}
<div class="strata-ticket-card" data-ticket-id="{{ ticket.id }}" draggable="true">
  <a href="{{ ticket_url }}" class="strata-ticket-card__link">
    <div class="strata-ticket-card__header">
      {% if ticket_type %}
        <span class="strata-ticket-card__type strata-ticket-card__type--{{ ticket_type.label|clean_class }}">
          {{ ticket_type.label }}
        </span>
      {% endif %}
    </div>

    <h3 class="strata-ticket-card__title">{{ title }}</h3>

    <div class="strata-ticket-card__footer">
      <div class="strata-ticket-card__meta">
        {% if created %}
          <span class="strata-ticket-card__created" title="Created {{ created|date('M j, Y') }}">
            <svg class="strata-ticket-card__icon" viewBox="0 0 20 20" fill="currentColor" width="14" height="14">
              <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
            </svg>
            {{ created|date('M j') }}
          </span>
        {% endif %}

        {% if deadline %}
          <span class="strata-ticket-card__deadline {% if deadline < date() %}strata-ticket-card__deadline--overdue{% endif %}" title="Deadline {{ deadline|date('M j, Y') }}">
            <svg class="strata-ticket-card__icon" viewBox="0 0 20 20" fill="currentColor" width="14" height="14">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
            </svg>
            {{ deadline|date('M j') }}
          </span>
        {% endif %}

        {% if comment_count > 0 %}
          <span class="strata-ticket-card__comments" title="{{ comment_count }} comment{{ comment_count != 1 ? 's' : '' }}">
            <svg class="strata-ticket-card__icon" viewBox="0 0 20 20" fill="currentColor" width="14" height="14">
              <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"/>
            </svg>
            {{ comment_count }}
          </span>
        {% endif %}

        {% if file_count > 0 %}
          <span class="strata-ticket-card__files" title="{{ file_count }} file{{ file_count != 1 ? 's' : '' }}">
            <svg class="strata-ticket-card__icon" viewBox="0 0 20 20" fill="currentColor" width="14" height="14">
              <path fill-rule="evenodd" d="M8 4a3 3 0 00-3 3v4a5 5 0 0010 0V7a1 1 0 112 0v4a7 7 0 11-14 0V7a5 5 0 0110 0v4a3 3 0 11-6 0V7a1 1 0 012 0v4a1 1 0 102 0V7a3 3 0 00-3-3z" clip-rule="evenodd"/>
            </svg>
            {{ file_count }}
          </span>
        {% endif %}
      </div>

      {% if assigned_to %}
        <span class="strata-ticket-card__assignee" title="Assigned to {{ assigned_to.label }}">
          <span class="strata-ticket-card__avatar">
            {{ assigned_to.label|first|upper }}
          </span>
        </span>
      {% endif %}
    </div>
  </a>
</div>
